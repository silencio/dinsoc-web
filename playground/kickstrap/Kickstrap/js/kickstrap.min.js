function kickstrapReady(e){if(appCheck){this.loadedLoop=[];for(var t=0;t<appArray.length||function(){this.loadedLoop.every(Boolean)&&ks.fire()}();t++){var n=appArray[t].countRequired,r=appArray[t].countDependent;n[0]==n[1]&&r[0]==r[1]?appArray[t].loaded=!0:appArray[t].loaded=!1,this.loadedLoop.push(appArray[t].loaded)}}}function consoleLog(e,t,n){var r="KS: ";if(ks.opts.console&&window.console)if(n)console.log([e,n]);else switch(t){case"warn":console.warn(r+e);break;case"error":console.error(r+e);break;default:console.log(r+e)}}function setDir(e,t){t=="root"&&(ks.opts.rootDir=ks.opts.rootDir||e),t=="universal"&&(ks.opts.universals=ks.opts.universals||e)}function clearCache(e){var t="w"==(localStorage.setItem="w");t?(localStorage.clear(),consoleLog("Cache has been cleared. Reloading..."),location.reload(!0)):consoleLog("This browser does not support localStorage.","error")}function formatString(e,t){return e=String(e),t?(e=String(e),e=e.replace(/\\'/g,"'"),e=e.replace(/\\"/g,'"'),e=e.replace(/\\0/g,"\0"),e=e.replace(/\\\\/g,"\\"),e=e.substring(1,e.length-1)):e=e.replace(/['"]/g,""),e=e.replace(/br-/ig,";"),e}function getInternetExplorerVersion(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e}function themeFunction(e){$.ajax({type:"GET",url:ks.opts.rootDir+"Kickstrap/themes/"+e+"/functions.js",dataType:"script",context:self})}function setupKickstrap(){if($("#appList").css("content")=="normal"||$("#appList").css("content")==undefined){contentHack.selector="ie8";if($("#appList").css("ie8")==undefined||$("#appList").css("ie8")==""){var e="";contentHack.parse=!0;for(var t=0;t<document.styleSheets.length;t++){if(document.styleSheets[t].rules==null)continue;for(var n=0;n<document.styleSheets[t].rules.length;n++){var r=document.styleSheets[t].rules[n].selectorText;if(r=="#appList")ks.apps=ks.apps.concat(formatString(document.styleSheets[t].rules[n].style.content,!0).splitCSV());else if(r=="script#rootDir"||r=="script#console"||r=="script#caching")e+=formatString(document.styleSheets[t].rules[n].style.content,!0)}}document.write(e)}}document.write('<script id="rootDir" type="text/javascript">appendMagic(\'#rootDir\');</script><script id="themeFunctions">appendMagic(\'#themeFunctions\');</script><script id="console" type="text/javascript">appendMagic(\'#console\');</script><script id="caching" type="text/javascript">appendMagic(\'#caching\');initKickstrap();</script>')}function appendMagic(e){if(!contentHack.parse){var t=formatString($(e).css(contentHack.selector),!0);if(t=="ndefine"||t=="on")t="<script></script>";document.write(t)}}function initKickstrap(){!universalsSet&&ks.opts.universals=="none"&&(universalsSet=!0);if(universalsSet){contentHack.parse||(ks.apps=ks.apps.concat(formatString($("#appList").css(contentHack.selector)).splitCSV())),ver!=8&&(ks.apps=ks.apps.filter(function(e,t){return ks.apps.indexOf(e)==t}));for(var e=0;e<ks.apps.length;e++)theapp=ks.apps[e],theapp.isIgnored()&&(ks.apps.remove(e),e--);ks.apps.length==0&&ks.fire();for(var e=0;e<ks.apps.length;e++)theapp=ks.apps[e],window[ks.apps[e]]=new app(theapp)}else universal=new app("universal")}function cssIfy(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.getElementsByTagName("body")[0].appendChild(t)}function app(e){function t(t){var n=t[0].splitCSV();for(i=0;i<n.length;i++)n[i].isIgnored()&&n.splice(n.indexOf(n[i]),1);window[e].resourcesRequired=n;if(t[1]){var s=t[1].splitCSV();for(i=0;i<s.length;i++)s[i].isIgnored()&&s.splice(s.indexOf(s[i]),1);window[e].resourcesDependent=s}appArray.push(window[e]),universalsSet||r(),appArray.length==ks.apps.length&&r()}function n(){universalsSet=!0,appArray=[],initKickstrap()}function r(){universalsSet&&ks.apps.length>0&&(appCheck=!0);for(var e=0;e<appArray.length||function(){!universalsSet&&appArray[0].countRequired[1]==0&&n()}();e++){appArray[e].countRequired[0]=0,consoleLog("KS: "+appArray[e].name,null,appArray[e]);for(var t=0;t<appArray[e].resourcesRequired.length;t++){var r=appArray[e].resourcesRequired[t],i=configPath+appArray[e].name+"/"+r;r.isPublic()&&(i=r),r.isIgnored()||(r.isJS()?$.ajax({type:"GET",url:i,dataType:"script",context:this,beforeSend:function(t,n){t.thisIs=appArray[e],t.thisIs.countRequired[1]++},success:function(e,t,n){var r=n.thisIs;r.countRequired[0]++;if(r.countRequired[0]==r.countRequired[1]){universalsSet||(universalsSet=!0,appArray=[],initKickstrap(),universal.countDependent=[0,0]),r.countDependent[0]=0,kickstrapReady(r.name);for(var i=0;i<r.resourcesDependent.length;i++){var s=configPath+r.name+"/"+r.resourcesDependent[i];r.resourcesDependent[i].isPublic()&&(s=r.resourcesDependent[i]),s.isJS()?$.ajax({type:"GET",url:s,dataType:"script",context:this,beforeSend:function(e,t){e.thisIs=r,e.thisIs.countDependent[1]++},success:function(e,t,n){var r=n.thisIs;r.countDependent[0]++,kickstrapReady(r.name)}}):(r.countDependent[0]++,r.countDependent[1]++,cssIfy(s))}}}}):(appArray[e].countRequired[0]++,appArray[e].countRequired[1]++,cssIfy(i)))}}}this.resourcesRequired=[],this.resourcesDependent=[],this.countRequired=[999,0],this.countDependent=[999,0],this.name=e,this.loaded=!1,configPath=ks.opts.rootDir+"Kickstrap/apps/",this.configPath=configPath+e+"/config.ks";if(e.substring(0,5)=="http:"||e.substring(0,6)=="https:")this.configPath=e;!universalsSet&&ks.opts.universals!="local"&&ks.opts.universals!=undefined&&(this.configPath=ks.opts.universals+"/universal/config.ks"),$.ajax({type:"GET",url:this.configPath,dataType:"html",context:self,success:function(e){this.resources=e.split(/\r\n|\n/),t(this.resources)},error:function(t,n,r){consoleLog('Could not load the app "'+e+'" ['+t.status+" ("+r+")]","error"),diagnosticMsgs.push("Verify your rootDir variable in kickstrap.less or in JavaScript has been set correctly."),diagnosticMsgs.push("Is the name of the app spelled correctly? Should match the name of the folder."),diagnosticMsgs.push("Do the above 404 errors reflect the right paths to files?.")}})}var contentHack={selector:"content",parse:!1},self=this,configPath,appArray=[],universalsSet=!1,readyFired=!1,appCheck=!1,thisVersion="1.2.0 Beta",diagnosticMsgs=[],rootDir,appList,kickstrap=new Object;if(!ks)var ks={};ks.opts||(ks.opts={}),ks.apps||(ks.apps=[]);var empty=[];ks.apps=empty.concat(ks.apps);if(!ks.opts.console||typeof ks.opts["console"]!="boolean")ks.opts.console=!1;ks.hello="KS: Hi! ("+thisVersion+")",ks.edit=function(){document.body.contentEditable="true",document.designMode="on",void 0,typeof window.$.pnotify=="function"?$.pnotify({title:"Prototyping Mode",text:"You can now edit anything in this page. (But it won't be saved!)",type:"success",styling:"bootstrap"}):consoleLog("You can now edit anything in this page. (But it won't be saved!")},ks.readyFxs=[],ks.ready=function(e){this.readyFxs.push(e)},kickstrap.ready=function(e){ks.readyFxs.push(e),consoleLog("Warning, kickstrap.ready is deprecated. Use ks.ready instead","warn")},ks.testParams={readyCount:0},ks.fire=function(){if(!readyFired){readyFired=!0,ks.testParams.readyCount++,consoleLog("Executing ks.ready() functions");for(var e=0;e<ks.readyFxs.length;e++)ks.readyFxs[e]();rootDir=ks.opts.rootDir,appList=ks.apps}},String.prototype.isIgnored=function(){return this.substr(0,2)=="//"||this==""},String.prototype.isPublic=function(){return this.substr(0,5)=="http:"||this.substr(0,6)=="https:"},String.prototype.isJS=function(){return this.substr(this.length-3,this.length)==".js"},String.prototype.splitCSV=function(e){for(var t=this.split(e=e||","),n=t.length-1,r;n>=0;n--)t[n]=t[n].replace(/ /g,""),t[n].replace(/"\s+$/,'"').charAt(t[n].length-1)=='"'?(r=t[n].replace(/^\s+"/,'"')).length>1&&r.charAt(0)=='"'?t[n]=t[n].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):n?t.splice(n-1,2,[t[n-1],t[n]].join(e)):t=t.shift().split(e).concat(t):t[n].replace(/""/g,'"');return t},Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,n)};if(typeof console=="undefined"||typeof console.log=="undefined")console={},console.log=function(){};"every"in Array.prototype||(Array.prototype.every=function(e,t){for(var n=0,r=this.length;n<r;n++)if(n in this&&!e.call(t,this[n],n,this))return!1;return!0}),"use strict","indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){t===undefined&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}),"filter"in Array.prototype||(Array.prototype.filter=function(e,t){var n=[],r;for(var i=0,s=this.length;i<s;i++)i in this&&e.call(t,r=this[i],i,this)&&n.push(r);return n});var ver=getInternetExplorerVersion();ver>-1&&(ver<9?contentHack.selector="ie8":contentHack.selector="content"),setTimeout(function(){if(!readyFired){consoleLog("I noticed your page still hasn't loaded."),diagnosticMsgs=diagnosticMsgs.filter(function(e,t){return diagnosticMsgs.indexOf(e)==t});if(diagnosticMsgs.length>0){consoleLog("-Diagnostics--------");for(var e=0;e<diagnosticMsgs.length;e++)consoleLog(diagnosticMsgs[e],"info");consoleLog("--------------------")}ks.opts.readyOverride?ks.fire():consoleLog("If you want ks.ready() to fire anyway, set ks.opts.readyOverride to true.")}},5e3),setupKickstrap();